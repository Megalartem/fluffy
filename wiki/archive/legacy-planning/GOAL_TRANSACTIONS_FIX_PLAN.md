# –ü–ª–∞–Ω: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —Ü–µ–ª–µ–π

**–î–∞—Ç–∞:** 15 —Ñ–µ–≤—Ä–∞–ª—è 2026  
**–ü—Ä–æ–±–ª–µ–º–∞:** –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ—Ç –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —Ü–µ–ª–µ–π –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–∞–∫ "Unknown category"  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (15 —Ñ–µ–≤—Ä–∞–ª—è 2026)

‚úÖ **–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `linkedGoalId` –≤ Transaction
- –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–≤—è–∑—å: Transaction.linkedGoalId ‚Üî GoalContribution.linkedTransactionId
- **–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ö–µ–º–∞ –ë–î (–≤–µ—Ä—Å–∏—è 9):** –¥–æ–±–∞–≤–ª–µ–Ω –∏–Ω–¥–µ–∫—Å –¥–ª—è linkedGoalId –≤ transactions

‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–µ–π:**
- –ü—Ä–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ü–µ–ª–∏ —á–µ—Ä–µ–∑ `goalService.contribute()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è linkedGoalId
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∏ contribution —Å–≤—è–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏

‚úÖ **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:**
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —Ü–µ–ª–µ–π –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç "Top up: {goalName}" –≤–º–µ—Å—Ç–æ "Unknown category"
- –ò–∫–æ–Ω–∫–∞ Target (–∑–µ–ª–µ–Ω–∞—è) —Å –±–µ–π–¥–∂–µ–º —Å—Ç—Ä–µ–ª–∫–∏
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ —Å–ø–∏—Å–∫–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ –≤ group view
- **‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ:** –†–µ—à–µ–Ω–∞ N+1 –ø—Ä–æ–±–ª–µ–º–∞ —á–µ—Ä–µ–∑ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫—É goals –∏ `fromList`

‚úÖ **–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ:**
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ contribution –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è —Å–≤—è–∑–∞–Ω–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ "–æ—Å–∏—Ä–æ—Ç–µ–≤—à–∏—Ö" —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- **‚úÖ –£–ª—É—á—à–µ–Ω error handling:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–µ—Ä–µ–¥ –æ—à–∏–±–∫–æ–π

‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
- ‚úÖ –ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ contribution (—Å—É–º–º–∞/–¥–∞—Ç–∞/–∑–∞–º–µ—Ç–∫–∞) –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- ‚úÖ **–ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ contribution**
- –ü–æ–ª–Ω–∞—è –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
- **–í TransactionUpsertSheet:**
  - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –±–∞–Ω–Ω–µ—Ä "üéØ Linked to goal: {goalName}"
  - –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∏–ø–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (type)
  - –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  - –ú–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ: —Å—É–º–º—É, –¥–∞—Ç—É, –∑–∞–º–µ—Ç–∫—É

‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `linkedGoalId` –≤ —Å—Ç–∞—Ä—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö
- **‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞:** Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤–º–µ—Å—Ç–æ —Ü–∏–∫–ª–∞
- **‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `requestIdleCallback` –≤–º–µ—Å—Ç–æ `setTimeout`

## ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (15 —Ñ–µ–≤—Ä–∞–ª—è 2026)

### 1. ‚úÖ –†–µ—à–µ–Ω–∞ N+1 –ø—Ä–æ–±–ª–µ–º–∞ –≤ TransactionRow
**–î–æ:** –ö–∞–∂–¥—ã–π TransactionRow –≤—ã–∑—ã–≤–∞–ª –æ—Ç–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ –ë–î –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ goal  
**–ü–æ—Å–ª–µ:**
- Goals –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –≤ TransactionsList —á–µ—Ä–µ–∑ `useGoals()`
- –ü–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ props –≤ TransactionsDayGroup –∏ TransactionRow
- `useGoal` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–ø—Ü–∏—é `fromList` –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

**–§–∞–π–ª—ã:**
- [TransactionsList.tsx](src/features/transactions/ui/components/TransactionsList/TransactionsList.tsx)
- [TransactionsDayGroup.tsx](src/features/transactions/ui/molecules/TransactionsDayGroup/TransactionsDayGroup.tsx)
- [TransactionRow.tsx](src/features/transactions/ui/molecules/TransactionRow/TransactionRow.tsx)

**–í—ã–∏–≥—Ä—ã—à:** 1 –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ N –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ goal-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

### 2. ‚úÖ –ü–æ–ª–Ω–∞—è –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –ú–µ—Ç–æ–¥ `findByLinkedTransactionId` –≤ contributionsRepo –∏ contributionsService
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è transaction ‚Üí contribution –≤ TransactionUpsertSheet
- –ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ goal-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è contribution

**–§–∞–π–ª—ã:**
- [repo.ts](src/features/goals/api/repo.ts) - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- [repo.dexie.ts](src/features/goals/api/repo.dexie.ts) - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- [contributions.service.ts](src/features/goals/model/contributions.service.ts)
- [TransactionUpsertSheet.tsx](src/features/transactions/ui/components/TransactionUpsertSheet/TransactionUpsertSheet.tsx)

### 3. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏
**–£–ª—É—á—à–µ–Ω–æ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `requestIdleCallback` –¥–ª—è –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- Batch –æ–ø–µ—Ä–∞—Ü–∏–∏: –≤—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ë–î
- Fallback –Ω–∞ `setTimeout(500ms)` –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤

**–§–∞–π–ª—ã:**
- [migrate-goal-transactions.ts](src/features/goals/model/migrate-goal-transactions.ts)
- [useGoalTransactionMigration.ts](src/features/goals/hooks/useGoalTransactionMigration.ts)

**–í—ã–∏–≥—Ä—ã—à:** –ú–∏–≥—Ä–∞—Ü–∏—è 100 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π: ~500ms –≤–º–µ—Å—Ç–æ ~5000ms

### 4. ‚úÖ –£–ª—É—á—à–µ–Ω error handling
**–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ contributionsService.delete():**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–µ—Ä–µ–¥ –≤—ã–±—Ä–æ—Å–æ–º –æ—à–∏–±–∫–∏
- –ï—Å–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —É–∂–µ —É–¥–∞–ª–µ–Ω–∞ - –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –±–µ–∑ –æ—à–∏–±–∫–∏
- –ï—Å–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ —É–¥–∞–ª–∏–ª–∞—Å—å - –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ–º AppError

**–§–∞–π–ª—ã:**
- [contributions.service.ts](src/features/goals/model/contributions.service.ts)
- [service.ts](src/features/transactions/model/service.ts) - –¥–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `getTransaction()`

### 5. ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ goals
**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- In-memory –∫—ç—à –≤ `useGoal` —Å TTL 5 –º–∏–Ω—É—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑ –ë–î –∏–ª–∏ `fromList`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –∫—ç—à–∞ –ø–æ timestamp

**–§–∞–π–ª—ã:**
- [useGoal.ts](src/features/goals/hooks/useGoal.ts)

**–í—ã–∏–≥—Ä—ã—à:** –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –æ–¥–Ω–æ–π —Ü–µ–ª–∏

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ü–µ–ª–∏ —á–µ—Ä–µ–∑ `goalService.contribute()`:
- –°–æ–∑–¥–∞–µ—Ç—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å `type: "transfer"` –∏ `categoryId: null`
- –í —Å–ø–∏—Å–∫–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è "Unknown category"
- –ù–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è –Ω–∞ —Å–≤—è–∑—å —Å —Ü–µ–ª—å—é
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å contribution
- –£–¥–∞–ª–µ–Ω–∏–µ contribution –Ω–µ —É–¥–∞–ª—è–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é

## –†–µ—à–µ–Ω–∏—è

- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–∏: **"Top up: {goalName}"**
- ‚úÖ –†–∞–∑—Ä–µ—à–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å **–¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π**
- ‚úÖ –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ contribution
- ‚úÖ –ò–∫–æ–Ω–∫–∞ **Target** —Å –±–µ–π–¥–∂–µ–º —Å—Ç—Ä–µ–ª–∫–∏

## –®–∞–≥–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –†–∞—Å—à–∏—Ä–∏—Ç—å –º–æ–¥–µ–ª—å Transaction
**–§–∞–π–ª:** [src/features/transactions/model/types.ts](src/features/transactions/model/types.ts)

- –î–æ–±–∞–≤–∏—Ç—å `linkedGoalId?: string | null` –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Transaction`
- –î–æ–±–∞–≤–∏—Ç—å –≤ `CreateTransactionInput`
- –î–æ–±–∞–≤–∏—Ç—å –≤ `UpdateTransactionPatch`
- –û–±–Ω–æ–≤–∏—Ç—å Zod —Å—Ö–µ–º—ã: `createTransactionInputSchema`, `updateTransactionPatchSchema`

### 2. –û–±–Ω–æ–≤–∏—Ç—å goalService.contribute
**–§–∞–π–ª:** [src/features/goals/model/service.ts](src/features/goals/model/service.ts#L100-L164)

–ú–µ—Ç–æ–¥ `contribute()`:
```typescript
const txInput: CreateTransactionInput = {
  workspaceId,
  type: "transfer",
  amountMinor,
  currency: goal.currency,
  categoryId: null,
  linkedGoalId: goal.id,  // ‚Üê –î–û–ë–ê–í–ò–¢–¨
  note: input.note?.trim() || null,
  dateKey,
};
```

### 3. –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
**–§–∞–π–ª:** [src/features/goals/model/contributions.service.ts](src/features/goals/model/contributions.service.ts)

–ú–µ—Ç–æ–¥ `delete()`:
```typescript
async delete(workspaceId: string, id: string): Promise<void> {
  // 1. –ü–æ–ª—É—á–∏—Ç—å contribution
  const contribution = await this.repo.getById(workspaceId, id);
  
  // 2. –ï—Å–ª–∏ –µ—Å—Ç—å linkedTransactionId - —É–¥–∞–ª–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
  if (contribution.linkedTransactionId) {
    await transactionService.deleteTransaction(
      workspaceId, 
      contribution.linkedTransactionId
    );
  }
  
  // 3. –£–¥–∞–ª–∏—Ç—å contribution
  await this.repo.delete(workspaceId, id);
}
```

### 4. –ó–∞–≥—Ä—É–∂–∞—Ç—å goals –≤ —Å–ø–∏—Å–∫–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
**–§–∞–π–ª:** [src/features/transactions/ui/components/TransactionsList/TransactionsList.tsx](src/features/transactions/ui/components/TransactionsList/TransactionsList.tsx)

```typescript
// –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É goals
const { data: goals } = useGoalsQuery({ workspaceId });

// –°–æ–∑–¥–∞—Ç—å map
const goalById = React.useMemo(
  () => goals?.reduce((acc, g) => ({ ...acc, [g.id]: g }), {}) ?? {},
  [goals]
);

// –ü–µ—Ä–µ–¥–∞—Ç—å –≤ TransactionsDayGroup
<TransactionsDayGroup
  goals={goals}
  goalById={goalById}
  // ...–æ—Å—Ç–∞–ª—å–Ω—ã–µ props
/>
```

### 5. –û–±–Ω–æ–≤–∏—Ç—å TransactionRow
**–§–∞–π–ª:** [src/features/transactions/ui/molecules/TransactionRow/TransactionRow.tsx](src/features/transactions/ui/molecules/TransactionRow/TransactionRow.tsx)

```typescript
interface Props {
  transaction: Transaction;
  category?: Category;
  goal?: Goal;  // ‚Üê –î–û–ë–ê–í–ò–¢–¨
  onPress?: () => void;
}

// –õ–æ–≥–∏–∫–∞ title
const title = React.useMemo(() => {
  if (transaction.linkedGoalId && goal) {
    return `Top up: ${goal.name}`;
  }
  return category?.name ?? "Unknown category";
}, [transaction, category, goal]);

// –ü–µ—Ä–µ–¥–∞—Ç—å linkedGoalId –≤ –∏–∫–æ–Ω–∫—É
<TransactionCategoryIcon
  type={transaction.type}
  icon={category?.icon}
  linkedGoalId={transaction.linkedGoalId}  // ‚Üê –î–û–ë–ê–í–ò–¢–¨
/>
```

### 6. –û–±–Ω–æ–≤–∏—Ç—å TransactionCategoryIcon
**–§–∞–π–ª:** [src/features/transactions/ui/atoms/TransactionCategoryIcon/TransactionCategoryIcon.tsx](src/features/transactions/ui/atoms/TransactionCategoryIcon/TransactionCategoryIcon.tsx)

```typescript
interface Props {
  type: TransactionType;
  icon?: string | null;
  linkedGoalId?: string | null;  // ‚Üê –î–û–ë–ê–í–ò–¢–¨
}

// –õ–æ–≥–∏–∫–∞ –∏–∫–æ–Ω–∫–∏
if (linkedGoalId) {
  return <IconBadgeButton icon="Target" badge="ArrowRight" />;
}

// –û—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
```

### 7. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
**–§–∞–π–ª:** [src/features/transactions/ui/components/TransactionUpsertSheet/TransactionUpsertSheet.tsx](src/features/transactions/ui/components/TransactionUpsertSheet/TransactionUpsertSheet.tsx)

- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å `linkedGoalId`:
  - –ó–∞–≥—Ä—É–∑–∏—Ç—å goal –∏ contribution
  - –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä: "üéØ Linked to goal: {goalName}"
  
- –í `onSubmit()`:
  ```typescript
  // –ï—Å–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å–≤—è–∑–∞–Ω–∞ —Å —Ü–µ–ª—å—é - –æ–±–Ω–æ–≤–∏—Ç—å contribution
  if (transaction.linkedGoalId && hasChanges) {
    const contribution = await findContributionByTransactionId(transaction.id);
    if (contribution) {
      await goalContributionsService.update(workspaceId, contribution.id, {
        amountMinor: values.amountMinor,
        dateKey: values.dateKey,
        note: values.note,
      });
    }
  }
  ```

### 8. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ contribution
**–§–∞–π–ª:** [src/features/goals/hooks/useGoalContributionMutation.ts](src/features/goals/hooks/useGoalContributionMutation.ts)

```typescript
const contributionUpdate = React.useCallback(
  async (id: string, patch: UpdateGoalContributionPatch) => {
    await withState(async () => {
      // 1. –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π contribution
      const contribution = await goalContributionsService.getById(workspaceId, id);
      
      // 2. –û–±–Ω–æ–≤–∏—Ç—å contribution
      await goalContributionsService.update(workspaceId, id, patch);
      
      // 3. –ï—Å–ª–∏ –µ—Å—Ç—å —Å–≤—è–∑–∞–Ω–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è - –æ–±–Ω–æ–≤–∏—Ç—å –µ—ë
      if (contribution.linkedTransactionId) {
        await transactionService.updateTransaction(
          workspaceId,
          contribution.linkedTransactionId,
          {
            amountMinor: patch.amountMinor,
            dateKey: patch.dateKey,
            note: patch.note,
          }
        );
      }
    });
  },
  [withState, workspaceId]
);
```

## –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

1. ‚úÖ **–†–∞—Å—à–∏—Ä–∏—Ç—å –º–æ–¥–µ–ª—å** (Step 1) - –±–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ - **–ó–ê–í–ï–†–®–ï–ù–û**
2. ‚úÖ **–û–±–Ω–æ–≤–∏—Ç—å goalService** (Step 2) - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–∏ - **–ó–ê–í–ï–†–®–ï–ù–û**
3. ‚úÖ **–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ** (Step 3) - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –±–∏—Ç—ã—Ö —Å—Å—ã–ª–æ–∫ - **–ó–ê–í–ï–†–®–ï–ù–û**
4. ‚úÖ **–ó–∞–≥—Ä—É–∑–∫–∞ goals** (Step 4) - –¥–∞–Ω–Ω—ã–µ –¥–ª—è UI - **–ó–ê–í–ï–†–®–ï–ù–û**
5. ‚úÖ **UI –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ** (Steps 5-6) - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è - **–ó–ê–í–ï–†–®–ï–ù–û**
6. ‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** (Steps 7-8) - –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–≤—è–∑—å - **–ó–ê–í–ï–†–®–ï–ù–û**
   - ‚úÖ contribution ‚Üí transaction
   - ‚úÖ transaction ‚Üí contribution
7. ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** - **–ó–ê–í–ï–†–®–ï–ù–û**
   - ‚úÖ N+1 –ø—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞
   - ‚úÖ Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –º–∏–≥—Ä–∞—Ü–∏–∏
   - ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ goals
   - ‚úÖ –£–ª—É—á—à–µ–Ω error handling

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### N+1 –ø—Ä–æ–±–ª–µ–º–∞
- **–î–æ:** 1 –∑–∞–ø—Ä–æ—Å goals + N –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π goal-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- **–ü–æ—Å–ª–µ:** 1 –∑–∞–ø—Ä–æ—Å goals –¥–ª—è –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- **–í—ã–∏–≥—Ä—ã—à:** –ü—Ä–∏ 50 goal-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö: 51 –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Üí 1 –∑–∞–ø—Ä–æ—Å

### –ú–∏–≥—Ä–∞—Ü–∏—è
- **–î–æ:** N –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- **–ü–æ—Å–ª–µ:** 1 batch —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- **–í—ã–∏–≥—Ä—ã—à:** –ü—Ä–∏ 100 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö: ~5000ms ‚Üí ~500ms (10x –±—ã—Å—Ç—Ä–µ–µ)

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **TTL:** 5 –º–∏–Ω—É—Ç
- **–í—ã–∏–≥—Ä—ã—à:** –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ goal: ~50ms ‚Üí <1ms

## –ü—Ä–æ–≤–µ—Ä–∫–∞ (QA)

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- [x] –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —Ü–µ–ª–∏
  - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ "Top up: {goalName}"
  - –ò–∫–æ–Ω–∫–∞ Target —Å –±–µ–π–¥–∂–µ–º —Å—Ç—Ä–µ–ª–∫–∏
  
- [x] –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—É–º–º—É –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
  - Contribution –æ–±–Ω–æ–≤–∏–ª—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
  - `goal.currentAmountMinor` –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
  
- [x] –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å contribution –≤ —Ü–µ–ª–∏
  - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ–±–Ω–æ–≤–∏–ª–∞—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
  - –°—É–º–º–∞, –¥–∞—Ç–∞, –∑–∞–º–µ—Ç–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
  
- [x] –£–¥–∞–ª–∏—Ç—å contribution
  - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Ç–æ–∂–µ —É–¥–∞–ª–∏–ª–∞—Å—å
  - –ù–µ—Ç "–æ—Å–∏—Ä–æ—Ç–µ–≤—à–∏—Ö" —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
  
- [x] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—ã—á–Ω—ã–µ transfer —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
  - –†–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ (–±–µ–∑ linkedGoalId)
  - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ —Å–ª–æ–º–∞–ª–æ—Å—å

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- [ ] –°–ø–∏—Å–æ–∫ —Å 50+ goal-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 1)
  - –í—Ä–µ–º—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ < 100ms
  
- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è 100+ —Å—Ç–∞—Ä—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
  - –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ñ–æ–Ω–µ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ UI
  - –ó–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∑–∞ < 1 —Å–µ–∫—É–Ω–¥—É
  
- [ ] –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –æ–¥–Ω–æ–º—É goal
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫—ç—à (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∫ –ë–î)
  - –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ

### Error handling
- [ ] –ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–∏—Ç—å contribution —Å —É–∂–µ —É–¥–∞–ª–µ–Ω–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–µ–π
  - –ù–µ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É
  - Contribution —É–¥–∞–ª—è–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
  
- [ ] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ goal-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ–º contribution
  - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
  - –í—ã–≤–æ–¥–∏—Ç—Å—è warning –≤ –∫–æ–Ω—Å–æ–ª—å

## –†–∏—Å–∫–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- ‚úÖ **–ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:** –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ goal transactions –Ω–µ –∏–º–µ—é—Ç `linkedGoalId`
  - ‚úÖ –†–µ—à–µ–Ω–æ: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Å batch –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
  
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ goals –≤ —Å–ø–∏—Å–∫–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
  - ‚úÖ –†–µ—à–µ–Ω–æ: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ö—É–∫ `useGoals`, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, N+1 –ø—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞
  
- **–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:** –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö –∏ —Ü–µ–ª—è—Ö
  - –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å optimistic locking –∏–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–±–µ–∂–¥–∞–µ—Ç

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã (–æ—Ç–∫–ª–æ–Ω–µ–Ω—ã)

- ‚ùå **–°–∫—Ä—ã—Ç—å goal transactions –∏–∑ —Å–ø–∏—Å–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**
  - –ü—Ä–∏—á–∏–Ω–∞: –ü–æ—Ç–µ—Ä—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å –≤—Å–µ –¥–≤–∏–∂–µ–Ω–∏—è
  
- ‚ùå **–ó–∞–ø—Ä–µ—Ç–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ goal transactions**
  - –ü—Ä–∏—á–∏–Ω–∞: –ù–µ–≥–∏–±–∫–æ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∑–∞—Ö–æ—Ç–µ—Ç—å –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

- –û–±–Ω–æ–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø–æ–∫–∞–∑–∞ goal contributions
- –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤ –∫–∞—Ä—Ç–æ—á–∫–µ —Ü–µ–ª–∏ "X transactions linked"
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é –ª–æ–≥–∏–∫—É –¥–ª—è budget allocations (–µ—Å–ª–∏ –ø–æ—è–≤—è—Ç—Å—è)
